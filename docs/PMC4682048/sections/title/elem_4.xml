<?xml version="1.0" encoding="UTF-8"?>
<sec disp-level="1" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Methods</div>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Climate simulations</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Two ensembles of regional climate simulations spanning the period 1970–2099 were used in this study. Both comprise the same 10 members (involving six different RCMs and five GCM runs; 
   <a ref-type="supplementary-material" rid="S1" href="#S1">Supplementary Table 1</a>), but one assumes the moderate RCP4.5 and the other the more marked RCP8.5 (ref. 
   <a ref-type="bibr" rid="b6" href="#b6">6</a>). The simulations were performed under the umbrella of the EURO-CORDEX project
   <a ref-type="bibr" rid="b11" href="#b11">11</a>
   <a ref-type="bibr" rid="b32" href="#b32">32</a>, cover Europe with a spatial resolution of 0.11° both in latitude and longitude, the finest so far in this type of climatological multi-model and multi-scenario experiments, and provide records of the output variables every 3 h. The ensemble mean climatologial patterns of all the magnitudes utilized in this study, that is, mean values and variability of several variables at various timescales, are provided in 
   <a ref-type="supplementary-material" rid="S1" href="#S1">Supplementary Figs 9 and 10</a> as a referential baseline.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">A concise evaluation exercise of the simulated RSDS, further supported by the results presented in ref. 
   <a ref-type="bibr" rid="b33" href="#b33">33</a>, is also included in 
   <a ref-type="supplementary-material" rid="S1" href="#S1">Supplementary Fig. 9</a>. All ensemble members are well able to capture both the spatial distribution and variability of the observed mean RSDS pattern, which is mainly dominated by a latitudinal gradient both in models and observations. Small negative errors (below 10%) appear in a few points mainly in the Iberian Peninsula, while overestimation errors prevail elsewhere reaching up to 20%. Excessive RSDS is a long-standing problem in climate modelling
   <a ref-type="bibr" rid="b34" href="#b34">34</a>
   <a ref-type="bibr" rid="b35" href="#b35">35</a>. There is, however, a number of points where positive biases grow even beyond 40%, usually located in mountainous regions, such as the Alps, where the limitation of climate models to reproduce single measurements is well known. Regarding RSDS variability, ensemble mean errors at the annual and monthly (daily) timescales are generally negative and mostly below 2% (10%), rarely up to 6% (15%). However, while the spatial distribution of the simulated monthly and daily variability patterns is acceptable, it is not the case for the annual variability simulated pattern. Nonetheless, taking into account (1) the small number of observational points, (2) the very nature of models that perform a spatial discretization of the simulation domain, along with the actual spatial representativeness of ground-based solar radiation measurements
   <a ref-type="bibr" rid="b36" href="#b36">36</a>, (3) the still moderate accuracy of models to properly reproduce cloudiness
   <a ref-type="bibr" rid="b37" href="#b37">37</a> and (4) the lack of a dynamically modelling of aerosols concentration levels, the results of this validation exercise are within an acceptable range, thus allowing a moderately high confidence on the analysed simulations.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">PV power potential and production</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The PV power output at a site depends on two factors: its PV power generation potential (PVpot) and the installed capacity. As defined and used in this study, PVpot is a dimensionless magnitude accounting for the performance of the PV cells with respect to their nominal power capacity according to the actual ambient conditions. Therefore, PVpot multiplied by the nominal installed watts of PV power capacity gives instantaneous PV power production.</p>
  <p xmlns="http://www.w3.org/1999/xhtml">PVpot mainly involves the amount of the resource (RSDS) but also the influence that other atmospheric variables may have on the efficiency of the PV cells, which diminishes as their temperature increases
   <a ref-type="bibr" rid="b38" href="#b38">38</a>. According to the literature
   <a ref-type="bibr" rid="b39" href="#b39">39</a>, it can be expressed as:
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">
   <div id="eq1" class="disp-formula">
    <span id="d33e616" xlink:href="ncomms10014-m1.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">where STC refers to standard test conditions (RSDS
   <sub>STC</sub>=1,000 W m
   <span class="sup">−2</span>), those for which the nominal capacity of a PV device is determined as its measured power output, and 
   <span class="italic">P</span>
   <sub>R</sub> is the so-called performance ratio, formulated to account for changes of the PV cells efficiency due to changes in their temperature as:
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">
   <div id="eq2" class="disp-formula">
    <span id="d33e632" xlink:href="ncomms10014-m2.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">where 
   <span class="italic">T</span>
   <sub>cell</sub> in the PV cell temperature, 
   <span class="italic">T</span>
   <sub>STC</sub>=25 °C and 
   <span class="italic">γ</span> is taken here as −0.005 °C
   <span class="sup">−1</span>, considering the typical response of monocrystalline silicon solar panels
   <a ref-type="bibr" rid="b40" href="#b40">40</a>. Finally, 
   <span class="italic">T</span>
   <sub>cell</sub> is modelled considering the effects of TAS, RSDS and VWS on it as:
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">
   <div id="eq3" class="disp-formula">
    <span id="d33e661" xlink:href="ncomms10014-m3.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">with 
   <span class="italic">c</span>
   <sub>1</sub>=4.3 °C, 
   <span class="italic">c</span>
   <sub>2</sub>=0.943, 
   <span class="italic">c</span>
   <sub>3</sub>=0.028 °C m
   <span class="sup">2</span> W
   <span class="sup">−1</span> and 
   <span class="italic">c</span>
   <sub>4</sub>=−1.528 °C sm
   <span class="sup">−1</span> according to ref. 
   <a ref-type="bibr" rid="b41" href="#b41">41</a>.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Hence, if ambient conditions (RSDS, TAS and VWS) correspond to the STCs, PVpot equals 1 and PV power production reaches the rated value. If they are so that 
   <span class="italic">T</span>
   <sub>cell</sub> is higher (lower) than 25 °C and/or RSDS lower (higher) than 1,000 W m
   <span class="sup">−2</span>, PVpot will be lower (higher) than the unit and the PV power output will be lower (higher) than the nominal power of the module.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The spatial distribution of PV power-installed capacity was obtained with the CLIMIX model as in ref. 
   <a ref-type="bibr" rid="b17" href="#b17">17</a>. Here it is applied to the 2050 regional targets set by the European Climate Foundation Roadmap 2050 in its 80% RES pathway
   <a ref-type="bibr" rid="b18" href="#b18">18</a> using the 0.11°-resolution working grid defined for EURO-CORDEX (
   <a ref-type="fig" rid="f2" href="#f2">Fig. 2</a>). CLIMIX performs an optimization exercise based on the resource availability for allocating PV plants (that is, by default, the preferred locations are those where RSDS is most abundant), but without overloading the best locations with huge deployments of PV installations, discarding sites previously identified as forestry or inaccessible areas and taking into account the population distribution.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Using the PVpot time series estimated as described above and the 2050 spatial scenario of PV power-installed capacity, 3-h time series of PV power generation were obtained for each grid cell of the domain holding PV power units. These series were finally aggregated per region, considering those regions for which the aforementioned 2050 targets were specified (
   <a ref-type="fig" rid="f2" href="#f2">Fig. 2</a>). As a result, nine 3-h time series of PV power generation spanning the period 1970–2099 were obtained, one per region, from each one of the available simulations. Ensemble mean values of their means and standard deviations (as computed here to assess changes in time variability) are presented in 
   <a ref-type="supplementary-material" rid="S1" href="#S1">Supplementary Fig. 11</a> as a reference.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Analysis of time variability</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Time variability is assessed here at various timescales (daily, monthly and annual) as follows. First, the 3-h series of PV power generation are daily, monthly and yearly aggregated and then detrended to avoid capturing long-term changes rather than those occurring at the scales of interest. In addition, multi-year monthly and daily means are removed from the monthly and daily series, respectively, to avoid the masking effect of the annual cycle of PVpot. Finally, annual, monthly and daily variability is just computed as the normalized standard deviation of the resulting series and expressed here in %. The normalization consists on dividing by the climatology of the historical period (that is, the 1970–1999 mean values) and was not performed in the case of the TAS series due to the very nature of this variable. The described procedure was applied either for the whole series or for the seasonally split series.</p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Assessment of projected changes</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Climate change signals from each individual ensemble member are computed as the difference between the value of the assessed magnitude in a 30-year-long future period (namely, 2070–2099) and its value in the reference period 1970–1999. The statistical significance of changes is evaluated using the Student's 
   <span class="italic">t</span>-test imposing 
   <span class="italic">p</span>&lt;0.05. For mean PVpot, mean VWS and mean PV power production, changes are expressed in relative terms (% with respect to the reference climatology); otherwise changes represent just the difference between future and historical values. Note that since variability is expressed here in %, variability changes are also given in %, but they do not represent variations in relative terms.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The ensemble mean (
   <span class="italic">E</span>
   <sub>mean</sub>) signals are computed as the arithmetic mean of the set of individual signals within each ensemble. The following criteria are used to consider them as either uncertain or negligible: at least two significant individual signals differ in the sign of the projected change (uncertain); the uncertainty condition is not fulfilled and less than a half of the individual signals are significant (negligible). Otherwise, the ensemble mean signals are referred to as robust.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">In addition, ensemble maximum and minimum (
   <span class="italic">E</span>
   <sub>max</sub> and 
   <span class="italic">E</span>
   <sub>min</sub>, respectively) signals are computed as the maximum and minimum values, respectively, of the whole set of individual signals. The ensemble spread denotes the range between these two limit values.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">TAS- and VWS-induced changes in PV power generation potential</div>
  <p xmlns="http://www.w3.org/1999/xhtml">By grouping equations 
   <a ref-type="disp-formula" rid="eq1" href="#eq1">(1)–(3)</a>, 
   <a href="#eq2">*</a>, 
   <a href="#eq3">*</a>, the expression of PVpot can be rewritten as:
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">
   <div id="eq4" class="disp-formula">
    <span id="d33e775" xlink:href="ncomms10014-m4.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">with 
   <span class="italic">α</span>
   <sub>1</sub>=1.1035 × 10
   <span class="sup">−3</span>, 
   <span class="italic">α</span>
   <sub>2</sub>=−1.4 × 10
   <span class="sup">−7</span>, 
   <span class="italic">α</span>
   <sub>3</sub>=−4.715 × 10
   <span class="sup">−6</span> and 
   <span class="italic">α</span>
   <sub>4</sub>=7.64 × 10
   <span class="sup">−6</span> in the corresponding units (PVpot should be dimensionless). Thereby, changes in PVpot are given by:
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">
   <div id="eq5" class="disp-formula">
    <span id="d33e813" xlink:href="ncomms10014-m5.jpg" class="inline-graphic" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   </div>
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Hence, taking ΔRSDS=ΔVWS=0 in equation 
   <a ref-type="disp-formula" rid="eq5" href="#eq5">(5)</a>, the change in PVpot due to a change in TAS can be obtained. Analogously, the change in PVpot due to the influence of changes in VWS alone is given by imposing ΔRSDS=ΔTAS=0 in equation 
   <a ref-type="disp-formula" rid="eq5" href="#eq5">(5)</a>. This is the procedure adopted here, as it was done in previous works
   <a ref-type="bibr" rid="b2" href="#b2">2</a>
   <a ref-type="bibr" rid="b3" href="#b3">3</a>
   <a ref-type="bibr" rid="b8" href="#b8">8</a>. However, note that the cross-products in the last two terms of equation 
   <a ref-type="disp-formula" rid="eq5" href="#eq5">(5)</a> make it impossible to fully isolate the contribution of each single field.
  </p>
 </sec>
 <sec disp-level="2" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">Detectability and S2N of projected changes</div>
  <p xmlns="http://www.w3.org/1999/xhtml">Two additional measures were employed to elucidate the forcefulness of the ensemble mean projected changes in PV power generation. The signal-to-noise ratio (S2N) refers to the ratio between the magnitude of the ensemble mean change and the ensemble spread. Detectability describes the ratio between the magnitude of the ensemble mean change and the ensemble mean annual variability of the PV power generation series. Therefore, a value of this ratio larger than unity implies that the magnitude of the ensemble mean change falls beyond the expected natural variability of the series.</p>
 </sec>
</sec>
